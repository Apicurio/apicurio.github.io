<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Installing Apicurio Registry using Docker :: Apicurio Registry</title>
    <link rel="canonical" href="https://www.apicur.io/registry/docs/apicurio-registry/3.1.x/getting-started/assembly-installing-registry-docker.html">
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Open+Sans" />
    <link rel="stylesheet" href="../../../assets/css/site.css">
    <link rel="stylesheet" href="https://www.apicur.io/css/rhbar.css">
<link rel="stylesheet" href="../../../assets/css/search.css">
    <link rel="shortcut icon" href="https://www.apicur.io/images/favicon.ico" type="image/x-icon" integrity="sha384-if9KH+NQ2dMhdrWu+INnJTcvG6riRakUAnbhecX5a7voubrapo7ouFGS+GYZ/N4P" crossorigin="anonymous"/>
  </head>
  <body class="article">
<div class="masthead-wrapper">
    <div class="search-box">
        <input id="search-input" type="text" placeholder="Search docs">
    </div>
    <div class="masthead">
        <div class="logo-wrapper">
            <a href="/"><img src="https://www.apicur.io/images/apicurio_headerlogo.png" class="project-logo"
                    title="Apicurio"></a>
        </div>
        <div class="menu-wrapper">
            <ul id="menu" class="menu">
                <li>
                    <a href="/studio/" id="menu-item-studio">Studio</a>
                </li>
                <li>
                    <a href="/registry/" id="menu-item-registry">Registry</a>
                </li>
                <li>
                    <a href="/datamodels/">Data Models</a>
                </li>
                <li>
                    <a href="/apicurito/">Apicurito</a>
                </li>
                <li>
                    <a href="/blog/">Blog</a>
                </li>
                <li>
                    <a href="/contact/">Contact</a>
                </li>
                <li>
                    <a href="https://github.com/apicurio">Fork</a>
                </li>
            </ul>
        </div>
    </div>
</div>
<script>
    var currentURL = window.location.href;
    var studioAnchor = document.getElementById("menu-item-studio");
    var registryAnchor = document.getElementById("menu-item-registry");

    if (currentURL.includes("studio")) {
        studioAnchor.classList.add("active");
    } else if (currentURL.includes("registry")) {
        registryAnchor.classList.add("active");
    }
</script>
<div class="body">
<div class="nav-container" data-component="apicurio-registry" data-version="3.1.x">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Apicurio Registry</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Introduction</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-intro-to-the-registry.html">Introduction to Apicurio Registry</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-intro-to-registry-rules.html">Apicurio Registry content rules</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Installation</span>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="assembly-installing-registry-docker.html">Installing Apicurio Registry using Docker</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-installing-registry-openshift.html">Installing Apicurio Registry on OpenShift</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-installing-registry-storage-openshift.html">Installing Apicurio Registry storage on OpenShift</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-deploying-registry-operator.html">Deploying Apicurio Registry using the Operator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-registry-high-availability.html">Deploying Apicurio Registry for high availability</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Migration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-migrating-registry-v2-v3.html">Migrating an existing Apicurio Registry deployment</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Configuration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-configuring-registry-security.html">Configuring Apicurio Registry security options</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-configuring-the-registry.html">Configuring your Apicurio Registry deployment</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Client applications</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-managing-registry-artifacts-ui.html">Managing Apicurio Registry content using the web console</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-managing-registry-artifacts-api.html">Managing Apicurio Registry content using the REST API</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-using-the-registry-client.html">Managing Apicurio Registry content using a SDK</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-managing-registry-artifacts-maven.html">Managing Apicurio Registry content using the Maven plug-in</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Apache Flink integration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-using-flink-catalog.html">Using Apicurio Registry with Apache Flink</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Kafka client serializers/deserialisers</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-using-kafka-client-serdes.html">Validating Kafka messages using serializers/deserializers in Java clients</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-configuring-kafka-client-serdes.html">Configuring Kafka serializers/deserializers in Java clients</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Troubleshooting</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="guide-exporting-registry-kafka-topic-data.html">Exporting Apicurio Registry Kafka topic data</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">AI Agent Integration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-a2a-features.html">A2A Protocol Features in Apicurio Registry</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-llm-artifact-types-implementation.html">LLM Artifact Types Implementation Guide</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Confluent Schema Registry Compatibility</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-confluent-schema-registry-compatibility.html">Confluent Schema Registry compatibility API</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Reference</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-artifact-reference.html">Apicurio Registry artifact reference</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-rule-reference.html">Apicurio Registry content rule reference</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-config-reference.html">Apicurio Registry configuration reference</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-operator-config-reference.html">Apicurio Registry Operator configuration reference</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Apicurio Registry</span>
    <span class="version">3.1.x</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Apicurio Registry</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">3.1.x</a>
        </li>
        <li class="version">
          <a href="../../3.0.x/index.html">3.0.x</a>
        </li>
        <li class="version">
          <a href="../../2.6.x/index.html">2.6.x</a>
        </li>
        <li class="version">
          <a href="../../2.5.x/index.html">2.5.x</a>
        </li>
        <li class="version">
          <a href="../../2.4.x/index.html">2.4.x</a>
        </li>
        <li class="version">
          <a href="../../2.3.x/index.html">2.3.x</a>
        </li>
        <li class="version">
          <a href="../../2.2.x/index.html">2.2.x</a>
        </li>
        <li class="version">
          <a href="../../2.1.x/index.html">2.1.x</a>
        </li>
        <li class="version">
          <a href="../../2.0.x/index.html">2.0.x</a>
        </li>
        <li class="version">
          <a href="../../1.3.3.Final/index.html">1.3.3.Final</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Apicurio Registry Operator</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../apicurio-registry-operator/1.2.0-dev-v2.6.x/index.html">1.2.0-dev-v2.6.x</a>
        </li>
        <li class="version">
          <a href="../../../apicurio-registry-operator/1.1.1-v2.5.9.final/index.html">1.1.1-v2.5.9.final</a>
        </li>
        <li class="version">
          <a href="../../../apicurio-registry-operator/1.1.0-v2.4.12.final/index.html">1.1.0-v2.4.12.final</a>
        </li>
        <li class="version">
          <a href="../../../apicurio-registry-operator/1.0.0/index.html">1.0.0</a>
        </li>
        <li class="version">
          <a href="../../../apicurio-registry-operator/0.0.4/index.html">0.0.4</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Apicurio Registry</a></li>
    <li>Installation</li>
    <li><a href="assembly-installing-registry-docker.html">Installing Apicurio Registry using Docker</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">3.1.x</button>
  <div class="version-menu">
    <a class="version is-current" href="assembly-installing-registry-docker.html">3.1.x</a>
    <a class="version" href="../../3.0.x/getting-started/assembly-installing-registry-docker.html">3.0.x</a>
    <a class="version" href="../../2.6.x/getting-started/assembly-installing-registry-docker.html">2.6.x</a>
    <a class="version" href="../../2.5.x/getting-started/assembly-installing-registry-docker.html">2.5.x</a>
    <a class="version" href="../../2.4.x/getting-started/assembly-installing-registry-docker.html">2.4.x</a>
    <a class="version" href="../../2.3.x/getting-started/assembly-installing-registry-docker.html">2.3.x</a>
    <a class="version" href="../../2.2.x/getting-started/assembly-installing-registry-docker.html">2.2.x</a>
    <a class="version" href="../../2.1.x/getting-started/assembly-installing-registry-docker.html">2.1.x</a>
    <a class="version" href="../../2.0.x/getting-started/assembly-installing-registry-docker.html">2.0.x</a>
    <a class="version" href="../../1.3.3.Final/getting-started/assembly-installing-registry-docker.html">1.3.3.Final</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/Apicurio/apicurio-registry">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Installing Apicurio Registry using Docker</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph _abstract">
<p>This chapter explains how to install and run Apicurio Registry using Docker with the following storage options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#installing-registry-in-memory-storage_registry">Installing Apicurio Registry with in-memory storage</a></p>
</li>
<li>
<p><a href="#installing-registry-sql-storage_registry">Installing Apicurio Registry with SQL database storage</a></p>
</li>
<li>
<p><a href="#installing-registry-kafka-storage_registry">Installing Apicurio Registry with Apache Kafka storage</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="assembly-intro-to-the-registry.html">Introduction to Apicurio Registry</a></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You can install more than one replica of Apicurio Registry depending on your environment. The number of replicas depends on your storage option, for example, your Kafka or database cluster configuration, and on the number and type of artifacts stored in Apicurio Registry.
</td>
</tr>
</table>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>For details on building from source, see <a href="https://github.com/Apicurio/apicurio-registry" class="bare">https://github.com/Apicurio/apicurio-registry</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="installing-registry-in-memory-storage_registry"><a class="anchor" href="#installing-registry-in-memory-storage_registry"></a>Installing Apicurio Registry with in-memory storage</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>This section explains how to install and run Apicurio Registry with simple in-memory storage from a container image.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The in-memory storage option is suitable for development only. All data is lost when the container image is restarted.
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You must have Docker installed and the Docker daemon running.</p>
</li>
<li>
<p>Ensure that you can connect to the container repository: <a href="https://hub.docker.com/r/apicurio/apicurio-registry" class="bare">https://hub.docker.com/r/apicurio/apicurio-registry</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Get the Apicurio Registry container image:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ docker pull apicurio/apicurio-registry:VERSION</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VERSION</code> is the Apicurio Registry release version, for example, <code>latest-release</code>. For more details, see <a href="https://hub.docker.com/r/apicurio/apicurio-registry/tags" class="bare">https://hub.docker.com/r/apicurio/apicurio-registry/tags</a>.</p>
</div>
</li>
<li>
<p>Run the container image:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ docker run -it -p 8080:8080 apicurio/apicurio-registry:VERSION</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
All storage variants of Apicurio Registry 3.x now share the same container image of <code>apicurio/apicurio-registry</code>.  This is in contrast to the separate container images used by Apicurio Registry 2.x.  Choosing a storage variant is now a matter of configuring the single backend/server container image.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Send a test request using the Apicurio Registry REST API. For example, enter the following <code>curl</code> command to create a simple Avro schema artifact for a share price application in the registry:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ curl -X POST -H "Content-type: application/json; artifactType=AVRO" -H "X-Registry-ArtifactId: share-price" --data '{"type":"record","name":"price","namespace":"com.example","fields":[{"name":"symbol","type":"string"},{"name":"price","type":"string"}]}' http://localhost:8080/apis/registry/v3/groups/my-group/artifacts</code></pre>
</div>
</div>
</li>
<li>
<p>Verify that the response includes the expected JSON body to confirm that the Avro schema artifact was created in the registry. For example:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">{"name":"price","createdBy":"","createdOn":"2021-03-19T17:48:17+0000","modifiedOn":"2021-03-19T17:48:17+0000","id":"share-price","version":1,"type":"AVRO","globalId":12,"state":"ENABLED","groupId":"my-group","contentId":12}</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>For more REST API sample requests, see the <a href="../assets-attachments/registry-rest-api.htm">Apicurio Registry REST API documentation</a>.</p>
</li>
<li>
<p>For demonstration examples, see <a href="https://github.com/Apicurio/apicurio-registry/tree/main/examples" class="bare">https://github.com/Apicurio/apicurio-registry/tree/main/examples</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="installing-registry-sql-storage_registry"><a class="anchor" href="#installing-registry-sql-storage_registry"></a>Installing Apicurio Registry with SQL database storage</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>This section explains how to install and run Apicurio Registry with storage in a PostgreSQL database from a container image. This storage option is suitable for production environments.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You must have Docker installed and the Docker daemon running.</p>
</li>
<li>
<p>Ensure that you can connect to the container repository: <a href="https://hub.docker.com/r/apicurio/apicurio-registry" class="bare">https://hub.docker.com/r/apicurio/apicurio-registry</a>.</p>
</li>
<li>
<p>You must already have a PostgreSQL database server installed and running. For example:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ postgres -D /usr/local/pgsql/data</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more details, see <a href="https://www.postgresql.org/docs/12/server-start.html" class="bare">https://www.postgresql.org/docs/12/server-start.html</a></p>
</div>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Get the Apicurio Registry container image:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ docker pull apicurio/apicurio-registry:VERSION</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VERSION</code> is the Apicurio Registry release version, for example, <code>latest-release</code>. For more details, see <a href="https://hub.docker.com/r/apicurio/apicurio-registry/tags" class="bare">https://hub.docker.com/r/apicurio/apicurio-registry/tags</a>.</p>
</div>
</li>
<li>
<p>Run the container image and specify the following environment variable for your Postgresql system:</p>
<div class="ulist">
<ul>
<li>
<p><code>APICURIO_STORAGE_KIND</code> - The storage variant.  Set this to <code>sql</code>.</p>
</li>
<li>
<p><code>APICURIO_STORAGE_SQL_KIND</code> - The type of SQL database to use.  Set this to <code>postgresql</code></p>
</li>
<li>
<p><code>APICURIO_DATASOURCE_URL</code> - The database connection URL.</p>
</li>
<li>
<p><code>APICURIO_DATASOURCE_USERNAME</code>, <code>APICURIO_DATASOURCE_PASSWORD</code> - The credentials for the PostgreSQL server.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ docker run -it -p 8080:8080 \
-e "APICURIO_STORAGE_KIND=sql" \
-e "APICURIO_STORAGE_SQL_KIND=postgresql" \
-e "APICURIO_DATASOURCE_URL=jdbc:postgresql://postgres/apicurio-registry" \
-e "APICURIO_DATASOURCE_USERNAME=apicurio-registry" \
-e "APICURIO_DATASOURCE_PASSWORD=password" \
apicurio/apicurio-registry:VERSION</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Send a test request using the Apicurio Registry REST API. For example, enter the following <code>curl</code> command to create a simple Avro schema artifact for a share price application in the registry:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ curl -X POST -H "Content-type: application/json" --data '{"artifactId":"share-price","artifactType":"AVRO","name":"Share Price","labels":{"environment":"DEV","category":"finance"},"firstVersion":{"version":"1.0.0","content":{"content":"{\"type\":\"record\",\"name\":\"price\",\"namespace\":\"com.example\",\"fields\":[{\"name\":\"symbol\",\"type\":\"string\"},{\"name\":\"price\",\"type\":\"string\"}]}","contentType":"application/json"}}}' http://localhost:8080/apis/registry/v3/groups/my-group/artifacts</code></pre>
</div>
</div>
</li>
<li>
<p>Verify that the response includes the expected JSON body to confirm that the Avro schema artifact was created in the registry. For example:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">{"artifact":{"name":"Share Price","owner":"","createdOn":"2024-09-26T16:26:03Z","modifiedBy":"","modifiedOn":"2024-09-26T16:26:03Z","artifactType":"AVRO","labels":{"environment":"DEV","category":"finance"},"groupId":"my-group","artifactId":"share-price"},"version":{"version":"1.0.0","owner":"","createdOn":"2024-09-26T16:26:03Z","artifactType":"AVRO","globalId":1,"state":"ENABLED","groupId":"my-group","contentId":1,"artifactId":"share-price"}}</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>For more REST API sample requests, see the <a href="../assets-attachments/registry-rest-api.htm">Apicurio Registry REST API documentation</a>.</p>
</li>
<li>
<p>For demonstration examples, see <a href="https://github.com/Apicurio/apicurio-registry/tree/main/examples" class="bare">https://github.com/Apicurio/apicurio-registry/tree/main/examples</a>.</p>
</li>
<li>
<p>For more details on PostgreSQL, see the <a href="https://www.postgresql.org/docs/12/index.html">PostgreSQL documentation</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="installing-registry-sql-storage-secrets_registry"><a class="anchor" href="#installing-registry-sql-storage-secrets_registry"></a>Using file-based secrets for database credentials</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>This section explains how to use file-based secrets for database credentials with Apicurio Registry when using Docker Compose.
This approach follows Docker&#8217;s recommended secret management practices and is more secure than passing credentials as
environment variables.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You must have Docker and Docker Compose installed.</p>
</li>
<li>
<p>You must already have a database server installed and running (PostgreSQL, MySQL, or Microsoft SQL Server).</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Overview</div>
<p>Instead of passing credentials and secrets as environment variables (which can be exposed in process lists and container
inspection), you can use file-based secrets. Apicurio Registry supports a generic <code>_FILE</code> suffix pattern that works with
<strong>any</strong> configuration property.</p>
</div>
<div class="paragraph">
<p>Environment variables are automatically converted to configuration properties by Quarkus. For example,
<code>APICURIO_DATASOURCE_PASSWORD_FILE</code> becomes the property <code>apicurio.datasource.password.file</code>. The
FileBasedSecretsConfigSource reads the file path from these properties and loads the actual values from the files.</p>
</div>
<div class="paragraph">
<div class="title">How it works</div>
<p>To use file-based secrets for any configuration property:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Take any environment variable name (e.g., <code>APICURIO_DATASOURCE_PASSWORD</code>)</p>
</li>
<li>
<p>Add <code>_FILE</code> suffix (e.g., <code>APICURIO_DATASOURCE_PASSWORD_FILE</code>)</p>
</li>
<li>
<p>Set the value to a file path containing the secret</p>
</li>
<li>
<p>Apicurio Registry reads the file contents and uses them as the actual property value</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This works for <strong>any</strong> configuration property, not just the examples listed below.</p>
</div>
<div class="paragraph">
<div class="title">Common file-based credential variables</div>
<p>Some commonly used file-based credential environment variables (and their corresponding properties):</p>
</div>
<div class="paragraph">
<p><strong>Database credentials:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>APICURIO_DATASOURCE_USERNAME_FILE</code> (property: <code>apicurio.datasource.username.file</code>)</p>
</li>
<li>
<p><code>APICURIO_DATASOURCE_PASSWORD_FILE</code> (property: <code>apicurio.datasource.password.file</code>)</p>
</li>
<li>
<p><code>APICURIO_DATASOURCE_BLUE_USERNAME_FILE</code> (property: <code>apicurio.datasource.blue.username.file</code>)</p>
</li>
<li>
<p><code>APICURIO_DATASOURCE_BLUE_PASSWORD_FILE</code> (property: <code>apicurio.datasource.blue.password.file</code>)</p>
</li>
<li>
<p><code>APICURIO_DATASOURCE_GREEN_USERNAME_FILE</code> (property: <code>apicurio.datasource.green.username.file</code>)</p>
</li>
<li>
<p><code>APICURIO_DATASOURCE_GREEN_PASSWORD_FILE</code> (property: <code>apicurio.datasource.green.password.file</code>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>OAuth/OIDC credentials:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>QUARKUS_OIDC_CLIENT_SECRET_FILE</code> (property: <code>quarkus.oidc.client-secret.file</code>)</p>
</li>
<li>
<p><code>APICURIO_UI_AUTH_OIDC_CLIENT_SECRET_FILE</code> (property: <code>apicurio.ui.auth.oidc.client-secret.file</code>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Kafka SASL credentials:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>APICURIO_KAFKASQL_SECURITY_SASL_CLIENT_ID_FILE</code> (property: <code>apicurio.kafkasql.security.sasl.client-id.file</code>)</p>
</li>
<li>
<p><code>APICURIO_KAFKASQL_SECURITY_SASL_CLIENT_SECRET_FILE</code> (property: <code>apicurio.kafkasql.security.sasl.client-secret.file</code>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Kafka SSL/TLS passwords:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>APICURIO_KAFKASQL_SECURITY_SSL_TRUSTSTORE_PASSWORD_FILE</code> (property:
<code>apicurio.kafkasql.security.ssl.truststore.password.file</code>)</p>
</li>
<li>
<p><code>APICURIO_KAFKASQL_SECURITY_SSL_KEYSTORE_PASSWORD_FILE</code> (property:
<code>apicurio.kafkasql.security.ssl.keystore.password.file</code>)</p>
</li>
<li>
<p><code>APICURIO_KAFKASQL_SECURITY_SSL_KEY_PASSWORD_FILE</code> (property: <code>apicurio.kafkasql.security.ssl.key.password.file</code>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Any other property:</strong></p>
</div>
<div class="paragraph">
<p>The <code>_FILE</code> suffix works with any configuration property. Simply add <code>_FILE</code> to any environment variable name and set
the value to a file path.</p>
</div>
<div class="paragraph">
<p>When a <code>_FILE</code> variant is set, Apicurio Registry reads the value from the specified file instead of using the direct
environment variable. Configuration precedence: System properties (400) &gt; File-based secrets (350) &gt; Environment
variables (300) &gt; application.properties (250).</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create a directory for your secret files:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ mkdir -p secrets</code></pre>
</div>
</div>
</li>
<li>
<p>Create files containing your database credentials:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ echo "pguser" &gt; secrets/db_user.txt
$ echo "pgpass" &gt; secrets/db_password.txt</code></pre>
</div>
</div>
</li>
<li>
<p>Set restrictive permissions on the secret files:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ chmod 600 secrets/*.txt</code></pre>
</div>
</div>
</li>
<li>
<p>Create a <code>docker-compose.yml</code> file that uses Docker Compose secrets:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">version: '3.8'

secrets:
  registry_db_user:
    file: ./secrets/db_user.txt
  registry_db_password:
    file: ./secrets/db_password.txt

services:
  apicurio-registry:
    image: apicurio/apicurio-registry:VERSION
    environment:
      APICURIO_STORAGE_KIND: "sql"
      APICURIO_STORAGE_SQL_KIND: "postgresql"
      APICURIO_DATASOURCE_URL: "jdbc:postgresql://postgres:5432/registrydb"
      APICURIO_DATASOURCE_USERNAME_FILE: /run/secrets/registry_db_user
      APICURIO_DATASOURCE_PASSWORD_FILE: /run/secrets/registry_db_password
    secrets:
      - registry_db_user
      - registry_db_password
    ports:
      - "8080:8080"</code></pre>
</div>
</div>
</li>
<li>
<p>Start the services:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ docker compose up -d</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">File format</div>
<p>Secret files should contain only the credential value in plain text (UTF-8 encoding). Leading and trailing whitespace
is automatically trimmed. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">mypassword</code></pre>
</div>
</div>
<div class="ulist">
<div class="title">Security considerations</div>
<ul>
<li>
<p>Ensure secret files have restrictive permissions (e.g., <code>chmod 600</code>)</p>
</li>
<li>
<p>Never commit secret files to version control (add them to <code>.gitignore</code>)</p>
</li>
<li>
<p>Apicurio Registry will log a warning if secret files are world-readable</p>
</li>
<li>
<p>If a <code>_FILE</code> variable is set but the file doesn&#8217;t exist or isn&#8217;t readable, Apicurio Registry will fail to start with a
clear error message</p>
</li>
</ul>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>For a complete Docker Compose example with secrets, see
<a href="https://github.com/Apicurio/apicurio-registry/tree/main/distro/docker-compose/pg-secrets">PostgreSQL with
file-based secrets example</a>.</p>
</li>
<li>
<p>For more details on Docker Compose secrets, see
<a href="https://docs.docker.com/compose/how-tos/use-secrets/">Docker Compose secrets documentation</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="installing-registry-kafka-storage_registry"><a class="anchor" href="#installing-registry-kafka-storage_registry"></a>Installing Apicurio Registry with Apache Kafka storage</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>This topic explains how to install and run Apicurio Registry with Kafka storage from a container image. The <code>kafkasql</code> storage option uses a Kafka topic for storage, along with an in-memory H2 database. This storage option is suitable for production environments.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>You must have Docker installed and the Docker daemon running.</p>
</li>
<li>
<p>Ensure that you can connect to the container repository: <a href="https://hub.docker.com/r/apicurio/apicurio-registry" class="bare">https://hub.docker.com/r/apicurio/apicurio-registry</a>.</p>
</li>
<li>
<p>Ensure that <code>KAFKA_HOME</code> is set to the location of your Kafka-based system.</p>
</li>
<li>
<p>You must already have your Kafka broker running. For example:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$KAFKA_HOME/bin/zookeeper-server-start.sh $KAFKA_HOME/config/zookeeper.properties &amp;
$KAFKA_HOME/bin/kafka-server-start.sh $KAFKA_HOME/config/server.properties &amp;</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more details, see <a href="https://kafka.apache.org/quickstart" class="bare">https://kafka.apache.org/quickstart</a>.</p>
</div>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Get the Apicurio Registry container image:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ docker pull apicurio/apicurio-registry:VERSION</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>VERSION</code> is the Apicurio Registry release version, for example, <code>latest-release</code>. For more details, see <a href="https://hub.docker.com/r/apicurio/apicurio-registry/tags" class="bare">https://hub.docker.com/r/apicurio/apicurio-registry/tags</a>.</p>
</div>
</li>
<li>
<p>Run the container image and specify the following environment variable for your Kafka system:</p>
<div class="ulist">
<ul>
<li>
<p><code>APICURIO_STORAGE_KIND</code> - Set this to <code>kafkasql</code></p>
</li>
<li>
<p><code>APICURIO_KAFKASQL_BOOTSTRAP_SERVERS</code> - The address(es) of your Kafka broker(s).</p>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ docker run -it -p 8080:8080 -e "APICURIO_STORAGE_KIND=kafkasql" -e "APICURIO_KAFKASQL_BOOTSTRAP_SERVERS=kafka:9092" apicurio/apicurio-registry:latest</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Send a test request using the Apicurio Registry REST API. For example, enter the following <code>curl</code> command to create a simple Avro schema artifact for a share price application in the registry:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ curl -X POST -H "Content-type: application/json" --data '{"artifactId":"share-price","artifactType":"AVRO","name":"Share Price","labels":{"environment":"DEV","category":"finance"},"firstVersion":{"version":"1.0.0","content":{"content":"{\"type\":\"record\",\"name\":\"price\",\"namespace\":\"com.example\",\"fields\":[{\"name\":\"symbol\",\"type\":\"string\"},{\"name\":\"price\",\"type\":\"string\"}]}","contentType":"application/json"}}}' http://localhost:8080/apis/registry/v3/groups/my-group/artifacts</code></pre>
</div>
</div>
</li>
<li>
<p>Verify that the response includes the expected JSON body to confirm that the Avro schema artifact was created in the registry. For example:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">{"artifact":{"name":"Share Price","owner":"","createdOn":"2024-09-26T16:26:03Z","modifiedBy":"","modifiedOn":"2024-09-26T16:26:03Z","artifactType":"AVRO","labels":{"environment":"DEV","category":"finance"},"groupId":"my-group","artifactId":"share-price"},"version":{"version":"1.0.0","owner":"","createdOn":"2024-09-26T16:26:03Z","artifactType":"AVRO","globalId":1,"state":"ENABLED","groupId":"my-group","contentId":1,"artifactId":"share-price"}}</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>For more REST API sample requests, see the <a href="../assets-attachments/registry-rest-api.htm">Apicurio Registry REST API documentation</a>.</p>
</li>
<li>
<p>For demonstration examples, see <a href="https://github.com/Apicurio/apicurio-registry/tree/main/examples" class="bare">https://github.com/Apicurio/apicurio-registry/tree/main/examples</a>.</p>
</li>
<li>
<p>For more details on Apache Kafka, see <a href="https://kafka.apache.org/documentation/" class="bare">https://kafka.apache.org/documentation/</a>.</p>
</li>
</ul>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>Copyright Â© 2024 Red Hat, Inc. All rights reserved.</p>
</footer>
<script src="../../../assets/js/site.js"></script>
<script src="../../../assets/js/vendor/lunr.js"></script>
<script src="../../../assets/js/vendor/search.js" id="search-script" data-base-path="../../.." data-page-path="/apicurio-registry/3.1.x/getting-started/assembly-installing-registry-docker.html"></script>
<script async src="../../../assets/../search-index.js"></script>
<script async src="../../../assets/js/vendor/highlight.js"></script>
  </body>
</html>
