<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Managing Apicurio Registry content using the REST API :: Apicurio Registry</title>
    <link rel="canonical" href="https://www.apicur.io/registry/docs/apicurio-registry/2.5.x/getting-started/assembly-managing-registry-artifacts-api.html">
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Open+Sans" />
    <link rel="stylesheet" href="../../../assets/css/site.css">
    <link rel="stylesheet" href="https://www.apicur.io/css/rhbar.css">
<link rel="stylesheet" href="../../../assets/css/search.css">
    <link rel="shortcut icon" href="https://www.apicur.io/images/favicon.ico" type="image/x-icon" integrity="sha384-if9KH+NQ2dMhdrWu+INnJTcvG6riRakUAnbhecX5a7voubrapo7ouFGS+GYZ/N4P" crossorigin="anonymous"/>
  </head>
  <body class="article">
<div id="rhbar">
    <a class="jbdevlogo" href="https://www.jboss.org/projects/about" rel="nofollow" target="_blank"></a>
    <a class="rhlogo" href="https://www.redhat.com/" rel="nofollow" target="_blank"></a>
</div>
<div class="masthead-header">

    <a href="" target="_blank" class="github-corner" aria-label="View source on Github">
        <svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg>
    </a>
    <div class="masthead-logo"></div>
    <div class="masthead-brand"><a href="/">Apicurio Studio</a></div>
    <div class="masthead-menu">
          <input id="search-input" type="text" placeholder="Search docs">
    </div>

    <div class="masthead-menu">
        <ul>
            <li><a href="/contact/">Contact</a></li>
        </ul>
    </div>
</div>
<div class="body">
<div class="nav-container" data-component="apicurio-registry" data-version="2.5.x">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Apicurio Registry</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Introduction</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-intro-to-the-registry.html">Introduction to Apicurio Registry</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-intro-to-registry-rules.html">Apicurio Registry content rules</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Installation</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-installing-registry-docker.html">Installing Apicurio Registry using Docker</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-installing-registry-openshift.html">Installing Apicurio Registry on OpenShift</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-installing-registry-storage-openshift.html">Installing Apicurio Registry storage on OpenShift</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="https://www.apicur.io/registry/docs/apicurio-registry-operator/1.0.0/index.html">Apicurio Registry Operator documentation</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Migration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-migrating-registry-v1-v2.html">Migrating an existing Apicurio Registry deployment</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Configuration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-configuring-registry-security.html">Configuring Apicurio Registry security options</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-configuring-the-registry.html">Configuring your Apicurio Registry deployment</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Client applications</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-managing-registry-artifacts-ui.html">Managing Apicurio Registry content using the web console</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="assembly-managing-registry-artifacts-api.html">Managing Apicurio Registry content using the REST API</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-using-the-registry-client.html">Managing Apicurio Registry content using a Java client</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-managing-registry-artifacts-maven.html">Managing Apicurio Registry content using the Maven plug-in</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Kafka client serializers/deserialisers</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-using-kafka-client-serdes.html">Validating Kafka messages using serializers/deserializers in Java clients</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-configuring-kafka-client-serdes.html">Configuring Kafka serializers/deserializers in Java clients</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Troubleshooting</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="guide-exporting-registry-kafka-topic-data.html">Exporting Apicurio Registry Kafka topic data</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Reference</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-artifact-reference.html">Apicurio Registry artifact reference</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-rule-reference.html">Apicurio Registry content rule reference</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="assembly-config-reference.html">Apicurio Registry configuration reference</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Apicurio Registry</span>
    <span class="version">2.5.x</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Apicurio Registry</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">2.5.x</a>
        </li>
        <li class="version">
          <a href="../../2.4.x/index.html">2.4.x</a>
        </li>
        <li class="version">
          <a href="../../2.3.x/index.html">2.3.x</a>
        </li>
        <li class="version">
          <a href="../../2.2.x/index.html">2.2.x</a>
        </li>
        <li class="version">
          <a href="../../2.1.x/index.html">2.1.x</a>
        </li>
        <li class="version">
          <a href="../../2.0.x/index.html">2.0.x</a>
        </li>
        <li class="version">
          <a href="../../1.3.3.Final/index.html">1.3.3.Final</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Apicurio Registry Operator</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../apicurio-registry-operator/1.2.0-dev-v2.x/index.html">1.2.0-dev-v2.x</a>
        </li>
        <li class="version">
          <a href="../../../apicurio-registry-operator/1.1.2-v2.5.11.final/index.html">1.1.2-v2.5.11.final</a>
        </li>
        <li class="version">
          <a href="../../../apicurio-registry-operator/1.1.1-v2.5.9.final/index.html">1.1.1-v2.5.9.final</a>
        </li>
        <li class="version">
          <a href="../../../apicurio-registry-operator/1.1.0-v2.4.12.final/index.html">1.1.0-v2.4.12.final</a>
        </li>
        <li class="version">
          <a href="../../../apicurio-registry-operator/1.0.0/index.html">1.0.0</a>
        </li>
        <li class="version">
          <a href="../../../apicurio-registry-operator/0.0.4/index.html">0.0.4</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Apicurio Registry</a></li>
    <li>Client applications</li>
    <li><a href="assembly-managing-registry-artifacts-api.html">Managing Apicurio Registry content using the REST API</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">2.5.x</button>
  <div class="version-menu">
    <a class="version is-current" href="assembly-managing-registry-artifacts-api.html">2.5.x</a>
    <a class="version" href="../../2.4.x/getting-started/assembly-managing-registry-artifacts-api.html">2.4.x</a>
    <a class="version" href="../../2.3.x/getting-started/assembly-managing-registry-artifacts-api.html">2.3.x</a>
    <a class="version" href="../../2.2.x/getting-started/assembly-managing-registry-artifacts-api.html">2.2.x</a>
    <a class="version" href="../../2.1.x/getting-started/assembly-managing-registry-artifacts-api.html">2.1.x</a>
    <a class="version" href="../../2.0.x/getting-started/assembly-managing-registry-artifacts-api.html">2.0.x</a>
    <a class="version" href="../../1.3.3.Final/getting-started/assembly-managing-registry-artifacts-api.html">1.3.3.Final</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/Apicurio/apicurio-registry">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Managing Apicurio Registry content using the REST API</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph _abstract">
<p>Client applications can use Apicurio Registry REST API operations to manage schema and API artifacts in Apicurio Registry, for example, in a CI/CD pipeline deployed in production. The Core Registry API v2 provides operations for artifacts, versions, metadata, and rules stored in Apicurio Registry. For detailed information, see the <a href="../assets-attachments/registry-rest-api.htm">Apicurio Registry REST API documentation</a>.</p>
</div>
<div class="paragraph">
<p>This chapter shows examples of how to use the Core Registry API v2 to perform the following tasks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#managing-artifacts-using-rest-api_registry">Managing schema and API artifacts using Apicurio Registry REST API commands</a></p>
</li>
<li>
<p><a href="#managing-artifact-versions-using-rest-api_registry">Managing schema and API artifact versions using Apicurio Registry REST API commands</a></p>
</li>
<li>
<p><a href="#managing-artifact-references-using-rest-api_registry">Managing schema and API artifact references using Apicurio Registry REST API commands</a></p>
</li>
<li>
<p><a href="#exporting-importing-using-rest-api_registry">Exporting and importing registry data using Apicurio Registry REST API commands</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p><a href="assembly-intro-to-the-registry.html">Introduction to Apicurio Registry</a></p>
</li>
</ul>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="../assets-attachments/registry-rest-api.htm">Apicurio Registry REST API documentation</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="managing-artifacts-using-rest-api_registry"><a class="anchor" href="#managing-artifacts-using-rest-api_registry"></a>Managing schema and API artifacts using Apicurio Registry REST API commands</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>This section shows a simple curl-based example of using the Core Registry API v2 to add and retrieve a simple schema artifact in Apicurio Registry.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Apicurio Registry is installed and running in your environment.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Add an artifact to Apicurio Registry using the <code>/groups/{group}/artifacts</code> operation. The following example <code>curl</code> command adds a simple schema artifact for a share price application:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ curl -X POST -H "Content-Type: application/json; artifactType=AVRO" \
  -H "X-Registry-ArtifactId: share-price" \
  -H "Authorization: Bearer $ACCESS_TOKEN" \
  --data '{"type":"record","name":"price","namespace":"com.example", \
   "fields":[{"name":"symbol","type":"string"},{"name":"price","type":"string"}]}' \
  MY-REGISTRY-URL/apis/registry/v2/groups/my-group/artifacts</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>This example adds an Apache Avro schema artifact with an artifact ID of <code>share-price</code>. If you do not specify a unique artifact ID, Apicurio Registry generates one automatically as a UUID.</p>
</li>
<li>
<p><code>MY-REGISTRY-URL</code> is the
host name on which Apicurio Registry is deployed. For example: <code>http://localhost:8080</code>.</p>
</li>
<li>
<p>This example specifies a group ID of <code>my-group</code> in the API path. If you do not specify a unique group ID, you must specify <code>../groups/default</code> in the API path.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Verify that the response includes the expected JSON body to confirm that the artifact was added. For example:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">{"createdBy":"","createdOn":"2021-04-16T09:07:51+0000","modifiedBy":"",
"modifiedOn":"2021-04-16T09:07:51+0000","id":"share-price","version":"1",
"type":"AVRO","globalId":2,"state":"ENABLED","groupId":"my-group","contentId":2}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>No version was specified when adding the artifact, so the default version <code>1</code> is created automatically.</p>
</li>
<li>
<p>This was the second artifact added to Apicurio Registry, so the global ID and content ID have a value of <code>2</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Retrieve the artifact content from Apicurio Registry using its artifact ID in the API path. In this example, the specified ID is <code>share-price</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ curl -H "Authorization: Bearer $ACCESS_TOKEN" \
 MY-REGISTRY-URL/apis/registry/v2/groups/my-group/artifacts/share-price
 {"type":"record","name":"price","namespace":"com.example",
  "fields":[{"name":"symbol","type":"string"},{"name":"price","type":"string"}]}</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>For more details, see the <a href="../assets-attachments/registry-rest-api.htm">Apicurio Registry REST API documentation</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="managing-artifact-versions-using-rest-api_registry"><a class="anchor" href="#managing-artifact-versions-using-rest-api_registry"></a>Managing schema and API artifact versions using Apicurio Registry REST API commands</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>If you do not specify an artifact version when adding schema and API artifacts using the Core Registry API v2, Apicurio Registry generates a version automatically. The default version when creating a new artifact  is <code>1</code>.</p>
</div>
<div class="paragraph">
<p>Apicurio Registry also supports custom versioning where you can specify a version using the <code>X-Registry-Version</code> HTTP request header as a string. Specifying a custom version value overrides the default version normally assigned when creating or updating an artifact. You can then use this version value when executing REST API operations that require a version.</p>
</div>
<div class="paragraph">
<p>This section shows a simple curl-based example of using the Core Registry API v2 to add and retrieve a custom Apache Avro schema version in Apicurio Registry. You can specify custom versions to add or update artifacts, or to add artifact versions.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Apicurio Registry is installed and running in your environment.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Add an artifact version in the registry using the <code>/groups/{group}/artifacts</code> operation. The following example <code>curl</code> command adds a simple artifact for a share price application:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ curl -X POST -H "Content-Type: application/json; artifactType=AVRO" \
  -H "X-Registry-ArtifactId: my-share-price" -H "X-Registry-Version: 1.1.1" \
  -H "Authorization: Bearer $ACCESS_TOKEN" \
  --data '{"type":"record","name":" p","namespace":"com.example", \
   "fields":[{"name":"symbol","type":"string"},{"name":"price","type":"string"}]}' \
   MY-REGISTRY-URL/apis/registry/v2/groups/my-group/artifacts</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>This example adds an Avro schema artifact with an artifact ID of <code>my-share-price</code> and version of <code>1.1.1</code>. If you do not specify a version, Apicurio Registry automatically generates a default version of <code>1</code>.</p>
</li>
<li>
<p><code>MY-REGISTRY-URL</code> is the
host name on which Apicurio Registry is deployed. For example: <code>http://localhost:8080</code>.</p>
</li>
<li>
<p>This example specifies a group ID of <code>my-group</code> in the API path. If you do not specify a unique group ID, you must specify <code>../groups/default</code> in the API path.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Verify that the response includes the expected JSON body to confirm that the custom artifact version was added. For example:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">{"createdBy":"","createdOn":"2021-04-16T10:51:43+0000","modifiedBy":"",
"modifiedOn":"2021-04-16T10:51:43+0000","id":"my-share-price","version":"1.1.1",
"type":"AVRO","globalId":3,"state":"ENABLED","groupId":"my-group","contentId":3}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>A custom version of <code>1.1.1</code> was specified when adding the artifact.</p>
</li>
<li>
<p>This was the third artifact added to the registry, so the global ID and content ID have a value of <code>3</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Retrieve the artifact content from the registry using its artifact ID and version in the API path. In this example, the specified ID is <code>my-share-price</code> and the version is <code>1.1.1</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ curl -H "Authorization: Bearer $ACCESS_TOKEN" \
MY-REGISTRY-URL/apis/registry/v2/groups/my-group/artifacts/my-share-price/versions/1.1.1
{"type":"record","name":"price","namespace":"com.example",
  "fields":[{"name":"symbol","type":"string"},{"name":"price","type":"string"}]}</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>For more details, see the <a href="../assets-attachments/registry-rest-api.htm">Apicurio Registry REST API documentation</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="managing-artifact-references-using-rest-api_registry"><a class="anchor" href="#managing-artifact-references-using-rest-api_registry"></a>Managing schema and API artifact references using Apicurio Registry REST API commands</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>Some Apicurio Registry artifact types can include <em>artifact references</em> from one artifact file to another. You can create efficiencies by defining reusable schema or API artifacts, and then referencing them from multiple locations in artifact references.</p>
</div>
<div class="paragraph">
<p>The following artifact types support artifact references:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Apache Avro</p>
</li>
<li>
<p>Google Protobuf</p>
</li>
<li>
<p>JSON Schema</p>
</li>
<li>
<p>OpenAPI</p>
</li>
<li>
<p>AsyncAPI</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This section shows a simple curl-based example of using the Core Registry API v2 to add and retrieve an artifact reference to a simple Avro schema artifact in Apicurio Registry.</p>
</div>
<div class="paragraph">
<p>This example first creates a schema artifact named <code>ItemId</code>:</p>
</div>
<div class="listingblock">
<div class="title">ItemId schema</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
    "namespace":"com.example.common",
    "name":"ItemId",
    "type":"record",
    "fields":[
        {
            "name":"id",
            "type":"int"
        }
    ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This example then creates a schema artifact named <code>Item</code>, which includes a reference to the nested <code>ItemId</code> artifact.</p>
</div>
<div class="listingblock">
<div class="title">Item schema with nested ItemId schema</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
    "namespace":"com.example.common",
    "name":"Item",
    "type":"record",
    "fields":[
        {
            "name":"itemId",
            "type":"com.example.common.ItemId"
        },
    ]
}</code></pre>
</div>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Apicurio Registry is installed and running in your environment.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Add the <code>ItemId</code> schema artifact that you want to create the nested artifact reference to using the <code>/groups/{group}/artifacts</code> operation:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ curl -X POST MY-REGISTRY-URL/apis/registry/v2/groups/my-group/artifacts \
   -H "Content-Type: application/json; artifactType=AVRO" \
   -H "X-Registry-ArtifactId: ItemId" \
   -H "Authorization: Bearer $ACCESS_TOKEN" \
   --data '{"namespace": "com.example.common", "type": "record", "name": "ItemId", "fields":[{"name":"id", "type":"int"}]}'</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>This example adds an Avro schema artifact with an artifact ID of <code>ItemId</code>. If you do not specify a unique artifact ID, Apicurio Registry generates one automatically as a UUID.</p>
</li>
<li>
<p><code>MY-REGISTRY-URL</code> is the
host name on which Apicurio Registry is deployed. For example: <code>http://localhost:8080</code>.</p>
</li>
<li>
<p>This example specifies a group ID of <code>my-group</code> in the API path. If you do not specify a unique group ID, you must specify <code>../groups/default</code> in the API path.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Verify that the response includes the expected JSON body to confirm that the artifact was added. For example:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">{"name":"ItemId","createdBy":"","createdOn":"2022-04-14T10:50:09+0000","modifiedBy":"","modifiedOn":"2022-04-14T10:50:09+0000","id":"ItemId","version":"1","type":"AVRO","globalId":1,"state":"ENABLED","groupId":"my-group","contentId":1,"references":[]}</code></pre>
</div>
</div>
</li>
<li>
<p>Add the <code>Item</code> schema artifact that includes the artifact reference to the <code>ItemId</code> schema using the <code>/groups/{group}/artifacts</code> operation:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ curl -X POST MY-REGISTRY-URL/apis/registry/v2/groups/my-group/artifacts \
-H 'Content-Type: application/create.extended+json' \
-H "X-Registry-ArtifactId: Item" \
-H 'X-Registry-ArtifactType: AVRO' \
-H "Authorization: Bearer $ACCESS_TOKEN" \
--data-raw '{
    "content": "{\r\n \"namespace\":\"com.example.common\",\r\n  \"name\":\"Item\",\r\n  \"type\":\"record\",\r\n  \"fields\":[\r\n   {\r\n  \"name\":\"itemId\",\r\n   \"type\":\"com.example.common.ItemId\"\r\n        }\r\n    ]\r\n}",
    "references": [
        {
            "groupId": "my-group",
            "artifactId": "ItemId",
            "name": "com.example.common.ItemId",
            "version": "1"
        }
    ]
}'</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>For artifact references, you must specify the custom content type of <code>application/create.extended+json</code>, which extends the <code>application/json</code> content type.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Verify that the response includes the expected JSON body to confirm that the artifact was created with the reference. For example:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">{"name":"Item","createdBy":"","createdOn":"2022-04-14T11:52:15+0000","modifiedBy":"","modifiedOn":"2022-04-14T11:52:15+0000","id":"Item","version":"1","type":"AVRO","globalId":2,"state":"ENABLED","groupId":"my-group","contentId":2, "references":[{"artifactId":"ItemId","groupId":"my-group","name":"ItemId","version":"1"}] }</code></pre>
</div>
</div>
</li>
<li>
<p>Retrieve the artifact reference from Apicurio Registry by specifying the global ID of the artifact that includes the reference. In this example, the specified global ID is <code>2</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ curl -H "Authorization: Bearer $ACCESS_TOKEN" MY-REGISTRY-URL/apis/registry/v2/ids/globalIds/2/references</code></pre>
</div>
</div>
</li>
<li>
<p>Verify that the response includes the expected JSON body for this artifact reference. For example:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">[{"groupId":"my-group","artifactId":"ItemId","version":"1","name":"com.example.common.ItemId"}]</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Dereference artifact content</div>
<p>There are some cases where returning artifact content with referenced content inline might be helpful. For these cases, the Core Registry API v2 supports the <code>dereference</code> query parameter in certain operations.</p>
</div>
<div class="paragraph">
<p>This support is currently implemented only for Avro, Protobuf, OpenAPI, AsyncAPI, and JSON Schema artifacts when the <code>dereference</code> parameter is specified in the API operation. This parameter is not supported for any other artifact types.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For Protobuf artifacts, dereferencing content is supported only when all the schemas belong to the same package.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Circular dependencies are allowed by some artifact types (e.g. JSON Schema) but are not supported by Apicurio Registry.
</td>
</tr>
</table>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>For more details, see the <a href="../assets-attachments/registry-rest-api.htm">Apicurio Registry REST API documentation</a>.</p>
</li>
<li>
<p>For more examples of artifact references, see the section on configuring each artifact type in <a href="assembly-configuring-kafka-client-serdes.html">Configuring Kafka serializers/deserializers in Java clients</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="exporting-importing-using-rest-api_registry"><a class="anchor" href="#exporting-importing-using-rest-api_registry"></a>Exporting and importing registry data using Apicurio Registry REST API commands</h2>
<div class="sectionbody">
<div class="paragraph _abstract">
<p>As an administrator, you can use the Core Registry API v2 to export data from one Apicurio Registry instance and import into another Apicurio Registry instance, so you can migrate data between different instances.</p>
</div>
<div class="paragraph">
<p>This section shows a simple curl-based example of using the Core Registry API v2 to export and import existing data in <code>.zip</code> format from one Apicurio Registry instance to another. All of the artifact data contained in the Apicurio Registry instance is exported in the <code>.zip</code> file.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You can import only Apicurio Registry data that has been exported from another Apicurio Registry instance.
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Apicurio Registry is installed and running in your environment.</p>
</li>
<li>
<p>Apicurio Registry instances have been created:</p>
<div class="ulist">
<ul>
<li>
<p>The source instance that you want to export data from contains at least one schema or API artifact.</p>
</li>
<li>
<p>The target instance that you want to import data into is empty to preserve unique IDs.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Export the Apicurio Registry data from your existing source Apicurio Registry instance:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ curl MY-REGISTRY-URL/apis/registry/v2/admin/export \
  -H "Authorization: Bearer $ACCESS_TOKEN" \
  --output my-registry-data.zip</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>MY-REGISTRY-URL</code> is the
host name on which the source Apicurio Registry is deployed. For example: <code>http://my-source-registry:8080</code>.</p>
</div>
</li>
<li>
<p>Import the registry data into your target Apicurio Registry instance:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ curl -X POST "MY-REGISTRY-URL/apis/registry/v2/admin/import" \
  -H "Content-Type: application/zip" -H "Authorization: Bearer $ACCESS_TOKEN" \
  --data-binary @my-registry-data.zip</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>MY-REGISTRY-URL</code> is the
host name on which the target Apicurio Registry is deployed. For example: <code>http://my-target-registry:8080</code>.</p>
</div>
</li>
</ol>
</div>
<div class="ulist _additional-resources">
<div class="title">Additional resources</div>
<ul>
<li>
<p>For more details, see the <code>admin</code> endpoint in the <a href="../assets-attachments/registry-rest-api.htm">Apicurio Registry REST API documentation</a>.</p>
</li>
<li>
<p>For details on export tools for migrating from Apicurio Registry version 1.x to 2.x, see <a href="https://github.com/Apicurio/apicurio-registry/tree/main/utils/exportV1">Apicurio Registry export utility for 1.x versions</a>.</p>
</li>
</ul>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>Copyright © 2023 Red Hat, Inc. All rights reserved.</p>
</footer>
<script src="../../../assets/js/site.js"></script>
<script src="../../../assets/js/vendor/lunr.js"></script>
<script src="../../../assets/js/vendor/search.js" id="search-script" data-base-path="../../.." data-page-path="/apicurio-registry/2.5.x/getting-started/assembly-managing-registry-artifacts-api.html"></script>
<script async src="../../../assets/../search-index.js"></script>
<script async src="../../../assets/js/vendor/highlight.js"></script>
  </body>
</html>
